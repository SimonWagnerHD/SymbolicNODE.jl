WARNING: both Symbolics and ModelingToolkit export "infimum"; uses of it in module DataDrivenDiffEq must be qualified
WARNING: both DataInterpolations and SymbolicUtils export "optimize"; uses of it in module DataDrivenDiffEq must be qualified
WARNING: both Symbolics and ModelingToolkit export "supremum"; uses of it in module DataDrivenDiffEq must be qualified
  Activating project at `~/home/SymbolicNODE.jl`
┌ Warning: ZygoteVJP tried and failed in the automated AD choice algorithm with the following error. (To turn off this printing, add `verbose = false` to the `solve` call)
└ @ SciMLSensitivity ~/.julia/packages/SciMLSensitivity/dM3nj/src/concrete_solve.jl:80
Compiling Tuple{typeof(RuntimeGeneratedFunctions.generated_callfunc), RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:ˍ₋arg1, :ˍ₋arg2, :ˍ₋arg3, :ˍ₋arg4, :ˍ₋arg5), Symbolics.var"#_RGF_ModTag", Symbolics.var"#_RGF_ModTag", (0x87fbc527, 0xaca47145, 0xb251d348, 0x65dd9dc9, 0x954aaa57)}, Vector{Any}, Vector{Float32}, Vector{Float32}, Int64, Vector{Any}}: type Nothing has no field code┌ Warning: ReverseDiffVJP tried and failed in the automated AD choice algorithm with the following error. (To turn off this printing, add `verbose = false` to the `solve` call)
└ @ SciMLSensitivity ~/.julia/packages/SciMLSensitivity/dM3nj/src/concrete_solve.jl:93
MethodError: no method matching gradient(::SciMLSensitivity.var"#255#258"{ODEProblem{false,Vector{Float32},Tuple{Float32, Float32},…}}, ::Vector{Float32}, ::Vector{Float32})

Some of the types have been truncated in the stacktrace for improved reading. To emit complete information
in the stack trace, evaluate `TruncatedStacktraces.VERBOSE[] = true` and re-run the code.

Closest candidates are:
  gradient(::Any, ::Any) at ~/.julia/packages/ReverseDiff/YkVxM/src/api/gradients.jl:21
  gradient(::Any, ::Any, !Matched::ReverseDiff.GradientConfig) at ~/.julia/packages/ReverseDiff/YkVxM/src/api/gradients.jl:21┌ Warning: TrackerVJP tried and failed in the automated AD choice algorithm with the following error. (To turn off this printing, add `verbose = false` to the `solve` call)
└ @ SciMLSensitivity ~/.julia/packages/SciMLSensitivity/dM3nj/src/concrete_solve.jl:107
KeyError: key (0x87fbc527, 0xaca47145, 0xb251d348, 0x65dd9dc9, 0x954aaa57) not found┌ Warning: Reverse-Mode AD VJP choices all failed. Falling back to numerical VJPs
└ @ SciMLSensitivity ~/.julia/packages/SciMLSensitivity/dM3nj/src/concrete_solve.jl:117
ERROR: LoadError: KeyError: key (0x87fbc527, 0xaca47145, 0xb251d348, 0x65dd9dc9, 0x954aaa57) not found
Stacktrace:
  [1] getindex(h::Dict{Any, Any}, key::NTuple{5, UInt32})
    @ Base ./dict.jl:498
  [2] (::RuntimeGeneratedFunctions.var"#8#9"{DataType, NTuple{5, UInt32}})()
    @ RuntimeGeneratedFunctions ~/.julia/packages/RuntimeGeneratedFunctions/6v5Gn/src/RuntimeGeneratedFunctions.jl:190
  [3] lock(f::RuntimeGeneratedFunctions.var"#8#9"{DataType, NTuple{5, UInt32}}, l::Base.Threads.SpinLock)
    @ Base ./lock.jl:185
  [4] _lookup_body(cache_tag::Type, id::NTuple{5, UInt32})
    @ RuntimeGeneratedFunctions ~/.julia/packages/RuntimeGeneratedFunctions/6v5Gn/src/RuntimeGeneratedFunctions.jl:188
  [5] generated_callfunc_body(argnames::NTuple{5, Symbol}, cache_tag::Type, id::NTuple{5, UInt32}, __args::NTuple{5, DataType})
    @ RuntimeGeneratedFunctions ~/.julia/packages/RuntimeGeneratedFunctions/6v5Gn/src/RuntimeGeneratedFunctions.jl:133
  [6] #s1#1
    @ ~/.julia/packages/RuntimeGeneratedFunctions/6v5Gn/src/RuntimeGeneratedFunctions.jl:229 [inlined]
  [7] var"#s1#1"(argnames::Any, cache_tag::Any, id::Any, ::Any, f::Any, __args::Any)
    @ Symbolics ./none:0
  [8] (::Core.GeneratedFunctionStub)(::Any, ::Vararg{Any})
    @ Core ./boot.jl:582
  [9] RuntimeGeneratedFunction
    @ ~/.julia/packages/RuntimeGeneratedFunctions/6v5Gn/src/RuntimeGeneratedFunctions.jl:124 [inlined]
 [10] _apply_function
    @ ~/.julia/packages/DataDrivenDiffEq/Z5a34/src/basis/build_function.jl:32 [inlined]
 [11] (::DataDrivenDiffEq.DataDrivenFunction{false, false, RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:ˍ₋arg1, :ˍ₋arg2, :ˍ₋arg3, :ˍ₋arg4, :ˍ₋arg5), Symbolics.var"#_RGF_ModTag", Symbolics.var"#_RGF_ModTag", (0x87fbc527, 0xaca47145, 0xb251d348, 0x65dd9dc9, 0x954aaa57)}, RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:ˍ₋out, :ˍ₋arg1, :ˍ₋arg2, :ˍ₋arg3, :ˍ₋arg4, :ˍ₋arg5), Symbolics.var"#_RGF_ModTag", Symbolics.var"#_RGF_ModTag", (0x74808070, 0x37bd6530, 0xde541828, 0x44626b81, 0xba2c24e4)}})(u::Vector{Float32}, p::Vector{Float32}, t::Int64)
    @ DataDrivenDiffEq ~/.julia/packages/DataDrivenDiffEq/Z5a34/src/basis/build_function.jl:52
 [12] (::DataDrivenDiffEq.Basis{false, false})(u::Vector{Float32}, p::Vector{Float32}, t::Int64)
    @ DataDrivenDiffEq ~/.julia/packages/DataDrivenDiffEq/Z5a34/src/basis/type.jl:278
 [13] (::DataDrivenDiffEq.DataDrivenSolution{Float32})(::Vector{Float32}, ::Vararg{Any})
    @ DataDrivenDiffEq ~/.julia/packages/DataDrivenDiffEq/Z5a34/src/solution.jl:49
 [14] (::SINDy{DataDrivenDiffEq.DataDrivenProblem{Float32, false, DataDrivenDiffEq.Continuous}, DataDrivenDiffEq.DataDrivenSolution{Float32}})(u::Vector{Float32})
    @ SymReg ~/home/SymbolicNODE.jl/src/SymReg.jl:32
 [15] node(u::Vector{Float32}, p::Vector{Float32}, t::Float32)
    @ Main ~/home/SymbolicNODE.jl/scripts/refine_sindy_node_cat.jl:37
 [16] ODEFunction
    @ ~/.julia/packages/SciMLBase/E9FrD/src/scimlfunctions.jl:2404 [inlined]
 [17] initialize!(integrator::ODEIntegrator{false,Tsit5{Static.False,…},Vector{Float32},Float32,…}, cache::OrdinaryDiffEq.Tsit5ConstantCache)
    @ OrdinaryDiffEq ~/.julia/packages/OrdinaryDiffEq/yspeT/src/perform_step/low_order_rk_perform_step.jl:700
 [18] __init(prob::ODEProblem{false,Vector{Float32},Tuple{Float32, Float32},…}, alg::Tsit5{Static.False,…}, timeseries_init::Tuple{}, ts_init::Tuple{}, ks_init::Tuple{}, recompile::Type{Val{true}}; saveat::Tuple{}, tstops::Tuple{}, d_discontinuities::Tuple{}, save_idxs::Nothing, save_everystep::Bool, save_on::Bool, save_start::Bool, save_end::Bool, callback::Nothing, dense::Bool, calck::Bool, dt::Float32, dtmin::Nothing, dtmax::Float32, force_dtmin::Bool, adaptive::Bool, gamma::Rational{Int64}, abstol::Nothing, reltol::Nothing, qmin::Rational{Int64}, qmax::Int64, qsteady_min::Int64, qsteady_max::Int64, beta1::Nothing, beta2::Nothing, qoldinit::Rational{Int64}, controller::Nothing, fullnormalize::Bool, failfactor::Int64, maxiters::Int64, internalnorm::typeof(DiffEqBase.ODE_DEFAULT_NORM), internalopnorm::typeof(LinearAlgebra.opnorm), isoutofdomain::typeof(DiffEqBase.ODE_DEFAULT_ISOUTOFDOMAIN), unstable_check::typeof(DiffEqBase.ODE_DEFAULT_UNSTABLE_CHECK), verbose::Bool, timeseries_errors::Bool, dense_errors::Bool, advance_to_tstop::Bool, stop_at_next_tstop::Bool, initialize_save::Bool, progress::Bool, progress_steps::Int64, progress_name::String, progress_message::typeof(DiffEqBase.ODE_DEFAULT_PROG_MESSAGE), userdata::Nothing, allow_extrapolation::Bool, initialize_integrator::Bool, alias_u0::Bool, alias_du0::Bool, initializealg::OrdinaryDiffEq.DefaultInit, kwargs::Base.Pairs{Symbol, Bool, Tuple{Symbol}, NamedTuple{(:save_noise,), Tuple{Bool}}})
    @ OrdinaryDiffEq ~/.julia/packages/OrdinaryDiffEq/yspeT/src/solve.jl:499
 [19] #__solve#627
    @ ~/.julia/packages/OrdinaryDiffEq/yspeT/src/solve.jl:5 [inlined]
 [20] #solve_call#22
    @ ~/.julia/packages/DiffEqBase/qPmC2/src/solve.jl:509 [inlined]
 [21] solve_up(prob::ODEProblem{false,Vector{Float32},Tuple{Float32, Float32},…}, sensealg::Nothing, u0::Vector{Float32}, p::Vector{Float32}, args::Tsit5{Static.False,…}; kwargs::Base.Pairs{Symbol, Bool, NTuple{4, Symbol}, NamedTuple{(:save_noise, :save_start, :save_end, :verbose), NTuple{4, Bool}}})
    @ DiffEqBase ~/.julia/packages/DiffEqBase/qPmC2/src/solve.jl:932
 [22] #solve#27
    @ ~/.julia/packages/DiffEqBase/qPmC2/src/solve.jl:842 [inlined]
 [23] _concrete_solve_adjoint(::ODEProblem{false,Vector{Float32},Tuple{Float32, Float32},…}, ::Tsit5{Static.False,…}, ::InterpolatingAdjoint{Bool,…}, ::Vector{Float32}, ::Vector{Float32}, ::SciMLBase.ChainRulesOriginator; save_start::Bool, save_end::Bool, saveat::Vector{Float32}, save_idxs::Nothing, kwargs::Base.Pairs{Symbol, Bool, Tuple{Symbol}, NamedTuple{(:verbose,), Tuple{Bool}}})
    @ SciMLSensitivity ~/.julia/packages/SciMLSensitivity/dM3nj/src/concrete_solve.jl:304
 [24] _concrete_solve_adjoint(::ODEProblem{false,Vector{Float32},Tuple{Float32, Float32},…}, ::Tsit5{Static.False,…}, ::Nothing, ::Vector{Float32}, ::Vector{Float32}, ::SciMLBase.ChainRulesOriginator; verbose::Bool, kwargs::Base.Pairs{Symbol, Vector{Float32}, Tuple{Symbol}, NamedTuple{(:saveat,), Tuple{Vector{Float32}}}})
    @ SciMLSensitivity ~/.julia/packages/SciMLSensitivity/dM3nj/src/concrete_solve.jl:188
 [25] #_solve_adjoint#53
    @ ~/.julia/packages/DiffEqBase/qPmC2/src/solve.jl:1348 [inlined]
 [26] #rrule#51
    @ ~/.julia/packages/DiffEqBase/qPmC2/src/solve.jl:1301 [inlined]
 [27] chain_rrule_kw
    @ ~/.julia/packages/Zygote/hLzJT/src/compiler/chainrules.jl:235 [inlined]
 [28] macro expansion
    @ ~/.julia/packages/Zygote/hLzJT/src/compiler/interface2.jl:0 [inlined]
 [29] _pullback
    @ ~/.julia/packages/Zygote/hLzJT/src/compiler/interface2.jl:9 [inlined]
 [30] _apply
    @ ./boot.jl:816 [inlined]
 [31] adjoint
    @ ~/.julia/packages/Zygote/hLzJT/src/lib/lib.jl:203 [inlined]
 [32] _pullback
    @ ~/.julia/packages/ZygoteRules/AIbCs/src/adjoint.jl:65 [inlined]
 [33] _pullback
    @ ~/.julia/packages/DiffEqBase/qPmC2/src/solve.jl:842 [inlined]
 [34] _pullback(::Zygote.Context{false}, ::DiffEqBase.var"##solve#27", ::Nothing, ::Nothing, ::Nothing, ::Val{true}, ::Base.Pairs{Symbol, Vector{Float32}, Tuple{Symbol}, NamedTuple{(:saveat,), Tuple{Vector{Float32}}}}, ::typeof(solve), ::ODEProblem{false,Vector{Float32},Tuple{Float32, Float32},…}, ::Tsit5{Static.False,…})
    @ Zygote ~/.julia/packages/Zygote/hLzJT/src/compiler/interface2.jl:0
 [35] _apply(::Function, ::Vararg{Any})
    @ Core ./boot.jl:816
 [36] adjoint
    @ ~/.julia/packages/Zygote/hLzJT/src/lib/lib.jl:203 [inlined]
 [37] _pullback
    @ ~/.julia/packages/ZygoteRules/AIbCs/src/adjoint.jl:65 [inlined]
 [38] _pullback
    @ ~/.julia/packages/DiffEqBase/qPmC2/src/solve.jl:832 [inlined]
 [39] _pullback(::Zygote.Context{false}, ::CommonSolve.var"#solve##kw", ::NamedTuple{(:saveat,), Tuple{Vector{Float32}}}, ::typeof(solve), ::ODEProblem{false,Vector{Float32},Tuple{Float32, Float32},…}, ::Tsit5{Static.False,…})
    @ Zygote ~/.julia/packages/Zygote/hLzJT/src/compiler/interface2.jl:0
 [40] _pullback
    @ ~/home/SymbolicNODE.jl/src/NeuralODE.jl:43 [inlined]
 [41] _pullback(::Zygote.Context{false}, ::NODE{Vector{Float32}, ODEProblem{false,Vector{Float32},Tuple{Float32, Float32},…}, Tsit5{Static.False,…}, Base.Pairs{Symbol, Union{}, Tuple{}, NamedTuple{(), Tuple{}}}}, ::Tuple{Vector{Float32}, Matrix{Float32}}, ::Vector{Float32})
    @ Zygote ~/.julia/packages/Zygote/hLzJT/src/compiler/interface2.jl:0
 [42] _pullback
    @ ~/home/SymbolicNODE.jl/src/NeuralODE.jl:42 [inlined]
 [43] _pullback(ctx::Zygote.Context{false}, f::NODE{Vector{Float32}, ODEProblem{false,Vector{Float32},Tuple{Float32, Float32},…}, Tsit5{Static.False,…}, Base.Pairs{Symbol, Union{}, Tuple{}, NamedTuple{(), Tuple{}}}}, args::Tuple{Vector{Float32}, Matrix{Float32}})
    @ Zygote ~/.julia/packages/Zygote/hLzJT/src/compiler/interface2.jl:0
 [44] _pullback
    @ ~/home/SymbolicNODE.jl/src/NeuralODE.jl:88 [inlined]
 [45] _pullback(ctx::Zygote.Context{false}, f::NeuralODE.var"#7#8"{typeof(Flux.Losses.mse), Matrix{Float32}, Vector{Float32}}, args::NODE{Vector{Float32}, ODEProblem{false,Vector{Float32},Tuple{Float32, Float32},…}, Tsit5{Static.False,…}, Base.Pairs{Symbol, Union{}, Tuple{}, NamedTuple{(), Tuple{}}}})
    @ Zygote ~/.julia/packages/Zygote/hLzJT/src/compiler/interface2.jl:0
 [46] pullback(f::Function, cx::Zygote.Context{false}, args::NODE{Vector{Float32}, ODEProblem{false,Vector{Float32},Tuple{Float32, Float32},…}, Tsit5{Static.False,…}, Base.Pairs{Symbol, Union{}, Tuple{}, NamedTuple{(), Tuple{}}}})
    @ Zygote ~/.julia/packages/Zygote/hLzJT/src/compiler/interface.jl:44
 [47] pullback
    @ ~/.julia/packages/Zygote/hLzJT/src/compiler/interface.jl:42 [inlined]
 [48] withgradient(f::Function, args::NODE{Vector{Float32}, ODEProblem{false,Vector{Float32},Tuple{Float32, Float32},…}, Tsit5{Static.False,…}, Base.Pairs{Symbol, Union{}, Tuple{}, NamedTuple{(), Tuple{}}}})
    @ Zygote ~/.julia/packages/Zygote/hLzJT/src/compiler/interface.jl:132
 [49] train_NODE(model::NODE{Vector{Float32}, ODEProblem{false,Vector{Float32},Tuple{Float32, Float32},…}, Tsit5{Static.False,…}, Base.Pairs{Symbol, Union{}, Tuple{}, NamedTuple{(), Tuple{}}}}, train_data::NODEData.NODEDataloader{Matrix{Float32}, Vector{Float32}, Int64}, epochs::Int64; valid_data::NODEData.NODEDataloader{Matrix{Float32}, Vector{Float32}, Int64}, η::Float32, print_every::Int64)
    @ NeuralODE ~/home/SymbolicNODE.jl/src/NeuralODE.jl:87
 [50] top-level scope
    @ ~/home/SymbolicNODE.jl/scripts/refine_sindy_node_cat.jl:42
in expression starting at /home/simonwa/home/SymbolicNODE.jl/scripts/refine_sindy_node_cat.jl:42
